(function(){angular.module("tecApp",["ngRoute"]);e.$inject=["$routeProvider","$locationProvider"];function e(e,t){e.when("/",{templateUrl:"home/home.view.html",controller:"homeCtrl",controllerAs:"vm"}).when("/history",{templateUrl:"history/history.view.html",controller:"historyCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"});t.html5Mode({enabled:true,requireBase:false})}angular.module("tecApp").config(["$routeProvider","$locationProvider",e])})();(function(){angular.module("tecApp").controller("homeCtrl",e);e.$inject=["tecData","taxCalculator"];function e(i,u){var c=this;c.pageHeader={title:"Tax Estimation Calculator",strapline:"Use this simple calculator to find out your estimated tax and net from a given income."};i.getTaxRateList().then(function e(t){var r=t.data;if(r.length>0){c.yearSeletorOptions=r;c.formData={year:r[0]}}},function e(t){console.log("Something went wrong when getting taxRates into year selector.")});i.getPersonalTaxRecordByEmail("test@gmail.com").then(function e(t){var r=t.data;if(r){c.personalTaxRecord=r}},function e(t){console.log("Something went wrong when getting personalTaxRecord.")});c.annualResult={gross:0,net:0,sup:0,netPlusSup:0,grossPlusSup:0,tax:0};c.onSubmit=function(){var e,t,r,o;var n,a,l,s;n=a=l=s=0;c.formError="";try{if(!c.formData.gross){e=0}else{e=parseInt(c.formData.gross);if(!e){throw"Gross field must be a number"}else if(e<0){throw"Gross field must large than zero"}}if(!c.formData.grossPlusSup){t=0}else{t=parseInt(c.formData.grossPlusSup);if(!t){throw"Gross + sup field must be a number"}else if(t<0){throw"Gross + sup field must large than zero"}}if(!c.formData.supRate){r=0}else{r=parseInt(c.formData.supRate);if(!r){throw"Sup rate field must be a number"}else if(r<0||r>100){throw"Sup rate must between 0 to 100"}}if(!(o=c.formData.year)){throw"Tax rate field is empty"}if(c.formData.gross&&c.formData.grossPlusSup&&e>t){throw"Gross field should less than gross + sup field"}e=u.getGross(e,t,r);a=u.getSup(e,t,r);t=u.getGrossPlusSup(t,e,a);l=u.getTax(e,o);n=u.getNet(e,l);s=u.getNetPlusSup(n,a);c.annualResult={gross:e,net:n,sup:a,netPlusSup:s,grossPlusSup:t,tax:l};i.postTaxResult(c.personalTaxRecord._id,c.annualResult).then(function e(t){console.log("Save succeed: "+t.data)},function e(t){console.log("Something went wrong when getting personalTaxRecord.")})}catch(e){c.formError=e}}}})();(function(){angular.module("tecApp").controller("historyCtrl",e);function a(e,t){var r=[];for(var o=0,n=-1;o<e.length;o++){var a=o%t;if(a==0){r[++n]=[]}r[n][a]=e[o]}return r}e.$inject=["tecData"];function e(e){var n=this;e.getPersonalTaxRecordByEmail("test@gmail.com").then(function e(t){var r=t.data;if(r){n.personalTaxRecord=r;n.historyMatrix=a(n.personalTaxRecord.taxResults,2)}},function e(t){console.log("Something went wrong when getting personalTaxRecord.")});n.deleteRecord=function(o){e.deleteTaxResult(n.personalTaxRecord._id,o).then(function e(t){console.log("Delete succeed");var r=n.personalTaxRecord.taxResults.map(function(e){return e._id}).indexOf(o);if(r>-1){n.personalTaxRecord.taxResults.splice(r,1);n.historyMatrix=a(n.personalTaxRecord.taxResults,2)}},function e(t){console.log("Something went wrong when deleting taxResult.")})}}})();(function(){angular.module("tecApp").directive("navigation",e);function e(){return{restrict:"EA",templateUrl:"/common/directives/navigation/navigation.template.html"}}})();(function(){angular.module("tecApp").directive("pageHeader",e);function e(){return{restrict:"EA",scope:{content:"=content"},templateUrl:"/common/directives/pageHeader/pageHeader.template.html"}}})();(function(){angular.module("tecApp").directive("footerGeneric",e);function e(){return{restrict:"EA",templateUrl:"/common/directives/footerGeneric/footerGeneric.template.html"}}})();(function(){angular.module("tecApp").service("tecData",e);e.$inject=["$http"];function e(r){var e=function(){return r.get("/api/taxRates")};var t=function(e){return r.get("/api/personalTaxRecords?email="+e)};var o=function(e,t){return r.post("/api/personalTaxRecords/"+e+"/taxResults",t)};var n=function(e,t){return r.delete("/api/personalTaxRecords/"+e+"/taxResults/"+t)};return{getTaxRateList:e,getPersonalTaxRecordByEmail:t,postTaxResult:o,deleteTaxResult:n}}})();(function(){angular.module("tecApp").service("taxCalculator",e);function e(){var e=function(e,t){return e-t};var n=function(e,t,r){var o=0;if(e&&r){o=e*r/100}else if(e&&t){o=t-e}else if(t&&r){o=t*r/(100+r)}return o};var t=function(e,t){return e+t};var r=function(e,t,r){var o;if(e){o=e}else if(t&&r){o=t-n(e,t,r)}else{o=0}return o};var o=function(e,t,r){var o;if(e){o=e}else{o=t+r}return o};var a=function(e,t){var r=null;var o=t.taxRanges;for(var n=0;n<o.length;n++){if(e<o[n].to||o[n].to==-1){r=o[n];break}}return(e-r.over)*r.percentage/100+r.amount};return{getNet:e,getSup:n,getNetPlusSup:t,getGross:r,getGrossPlusSup:o,getTax:a}}})();(function(){angular.module("tecApp").filter("formatFloat",e);function e(){return function(e,t){return e.toFixed(t)}}})();